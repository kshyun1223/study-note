# Database - Modeling

## 관계형 데이터베이스 기초

* CRUD: 어떤 데이터를 만나더라도 첫 번째로 할 일은 거기서 Create와 Read가 무엇일지 생각해보는 것이다. 서비스를 운영하면서 사용자에게 입력받고 사용자에게 출력해주는 모든 정보는 데이터베이스의 형태로 저장되기 때문이다.
* 테이블(table) : 연관된 데이터가 묶여있는 하나의 표. 데이터의 타입 혹은 구조를 나타나는 column(열)과 각각의 데이터를 구분하는 row(행, record)로 이루어져 있다.
* 스키마(schema) : 각각의 테이블이 모인 것을 스키마라고 한다
* 데이터베이스 서버(database server): 스키마가 여럿이 모이면 다시 데이터베이스 서버를 이루게 된다

## 개념적 데이터 모델링

### 기본 개념

* 데이터모델링은 개념들을 추출해내고 각각의 개념들은 어떻게 상호작용 하는지 도출해보는 단계이다. ER 다이어그램의 Peter Chen 표기법을 사용한다.
* ER 다이어그램 작업은 필요한 정보들을 뽑아내고, 연관있는 정보들끼리 서로 그룹을 지어주고, 그룹들 사이의 상호작용 관계를 정리하는 과정이다
* ER 다이어그램에서 특히 주목해야 하는 키워드는 정보, 그룹, 관계이다

### 엔티티(Entity, 정보)

* 데이터베이스에서 테이블의 역할을 하게 된다
* 엔티티는 특히 분간해내기 어려울 수 있는데 사용자 경험에서 읽기가 아니라 쓰기 위주로 살펴보면 잘 보인다. 게시판을 예로 들자면 글, 댓글, 유저와 같은 것들이 엔티티에 해당한다.

### 어트리뷰트(Attribute, 속성)

* 데이터베이스에서 컬럼의 역할을 하게 된다
* 게시물을 예로 들자면 게시물이 가지는 속성으로 제목, 본문, 생성일 같은 것들을 꼽아볼 수 있다

### 식별자(Identifier)

* 속성을 정의했으면 여러 속성들 중에 가장 중요한 하나를 정해야 하는데 이를 식별자라고 한다
* 식별자의 역할은 원하는 대상을 정확하게 타겟팅하는 것으로 데이터베이스의 핵심이라 할 수 있다
* 식별자로 사용될만한 컬럼들을 후보 키(candidate key)라고 하는데, 그 중에서 가장 중요한 것을 기본 키(primary key)라고 하고, 나머지를 대체 키(alternate key)라고 한다

### 관계(Relationship)

* 데이터베이스에서는 기본키와 외래키(Foreign Key)의 역할을 하게 된다
* 유저가 게시물과 댓글을 작성하면 작성이라는 관계가 도출된다
* 댓글은 글이 없으면 따로 존재할 수가 없으므로 글에 종속되어있는 종속관계이다
* cardinality : 1:1 관계, 1:N(1대 다) 관계, N:M(다대 다) 관계가 있다
* optionality : optional 관계와 mandatory 관계가 있다
  * optional 관계 : 예를 들어 유저는 댓글을 쓸 수도 있고 안 쓸 수도 있는데, 이 때 유저에게 댓글은 옵션(optional)이라고 볼 수 있다
  * mandatory 관계 : 댓글이 있으려면 누군가 유저가 작성을 해줘야만 하는데, 이 때 댓글에게 유저는 필수적인(mandatory) 대상이다

## 논리적 데이터 모델링

### 기본 개념

* 추출된 개념들을 표로 만들면 어떤 모습이 될지 그려보는 단계이다
* ER다이어그램의 Information Engineering 표기법을 사용한다
* 이 단계에서 정규화를 한다. ER다이어그램을 표로 만들기 위하여 정규형에 맞게 가공하는 단계라고 할 수 있다.
* 제1 정규형
  * atomic columns : 컬럼들이 원자화(atomic)되어야 한다
  * 하나의 컬럼에는 하나의 값만 들어가야 한다. 여러 개의 값이 들어있는 컬럼이 있다면 테이블을 분리해서 하나의 값만 가지게 만들어야 한다.
* 제2정규형
  * no partial dependencies : 부분 종속성이 없어야 한다
  * 어느 한 컬럼에만 종속되어 있고(연관되어 있고) 다른 컬럼에는 종속되어 있지 않은 컬럼들이 있다면 부분종속성이 성립된다. 테이블을 분리해서 부분종속성을 없애야 한다.
* 제3정규형
  * no transitive dependencies : 이행적 종속성이 없어야 한다
  * 컬럼들이 모두 동일하게 종속되어 있는(연관되어 있는) 것이 아니라 어떤 컬럼들은 다른 컬럼들을 거쳐서 간접적으로만 연관된 것을 이행적 종속이라고 한다
  * 이행적 종속이 나쁜 이유는 중복되는 내용이기 때문이다. 중복이 되는 값들을 분리해서 별도의 테이블로 만들어서 이행적 종속성을 없애야 한다.
  * 이행적 종속성은 얼핏 봐서는 잘 보이지 않을 수 있는데, 컬럼의 이름이 접두사와 접미사로 분리가 된다면 이행적 종속성이 성립될 확률이 크다.
